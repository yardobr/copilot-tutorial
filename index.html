<!-- 
    Generate an index HTML file for a tic-tac-toe game.
    The file should include:
    - A title "Tic-tac-toe"
    - A 3x3 table with square cells
    - A button to reset the game
    - A button to undo the last move
    - A link to "style.css" file
    - A link to main.js script file
    - A link to React library
    - A link to ReactDOM library
    - The label with a game result that should be initially hidden
    - The label with a game result should be visible when the game is over saying "Congratulations! Player X won!" where X is 1 or 2 depending on the winner
 -->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Tic-tac-toe</title>
        <link rel="stylesheet" href="style.css">
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    </head>
    <body>
        <h1 class="heading">Tic-tac-toe</h1>

        <p id="result"></p>

        <!-- Generate a 3x3 table with square cells -->
        <section class="table">
            <div class="row">
                <div class="cell"></div>
                <div class="cell"></div>
                <div class="cell"></div>
            </div>
            <div class="row">
                <div class="cell"></div>
                <div class="cell"></div>
                <div class="cell"></div>
            </div>
            <div class="row">
                <div class="cell"></div>
                <div class="cell"></div>
                <div class="cell"></div>
            </div>
        </section>

        <button class="btn" id="undo-btn">Undo the last move</button>
        <button class="btn" id="reset-btn">Reset the game</button>

        <!-- <script src="main.js" type="text/javascript" /> -->
        <!-- <script type="text/javascript"> -->
            // Create a game board
            const board = [
                [0, 0, 0],
                [0, 0, 0],
                [0, 0, 0]
            ];

            let currentPlayer = 1;

            function getCurrentPlayerSign() {
                return currentPlayer === 1 ? "x" : "o";
            }

            // Create a function makeMove that takes two parameters: row and column
            // it should set the value of the cell in the board array to the current player sign: "x" for player 1 and "o" for player 2
            function makeMove(row, column) {
                // Check if the cell is empty
                if (board[row][column] === 0) {
                    // Set the value of the cell in the board array to the current player sign
                    board[row][column] = currentPlayer;
                    // Check if the current player is 1
                    if (currentPlayer === 1) {
                        // Set the class "x" to the cell
                        $(this).addClass("x");
                        // Remove class "empty" from the cell
                        $(this).removeClass("empty");
                    } else {
                        // Set the class "o" to the cell
                        $(this).addClass("o");
                        // Remove class "empty" from the cell
                        $(this).removeClass("empty");
                    }
                    // Change the current player
                    currentPlayer = currentPlayer === 1 ? 2 : 1;

                    // Check if the game is finished after the move
                    checkForWinner();
                }
            }

            function checkRowsForWinner() {
                // Check if there are some rows with the same player sign using array .find() method
                const winningRow = board.find(row => {
                    if (row[0] !== 0) {
                        return row.every(cell => cell === row[0]);
                    }
                });
                return winningRow ? winningRow[0] : false;
            }

            function checkColumnsForWinner() {
                // Check for a winning column by analogy with the checkRowsForWinner() function
                const winningColumn = board.find((row, index) => {
                    if (row[0] !== 0) {
                        return board[0][index] === board[1][index] && board[1][index] === board[2][index];
                    }
                });
                return winningColumn ? winningColumn[0] : false;
            }

            function checkDiagonalsForWinner() {
                const diagonals = [
                    [board[0][0], board[1][1], board[2][2]],
                    [board[0][2], board[1][1], board[2][0]]
                ];

                const winningDiagonal = diagonals.find(diagonal => {
                    if (diagonal[0] !== 0) {
                        return diagonal.every(cell => cell === diagonal[0]);
                    }
                });

                return winningDiagonal ? winningDiagonal[0] : false;
            }

            function checkForWinner() {
                // Check if there is a row, column or diagonal with the same player sign
                const isGameFinished = checkRowsForWinner() || checkColumnsForWinner() || checkDiagonalsForWinner();
                if (isGameFinished) {
                    // Show the result label
                    $("#result").show();
                    // Set the text of the result label to "Congratulations! Player X won!" where X is 1 or 2 depending on the winner
                    $("#result").text(`Congratulations! Player ${isGameFinished} won!`);
                }
            }

            $(document).ready(function() {
                // Set class "empty" for all cells
                $(".cell").addClass("empty");
                $('.cell').click(function() {
                    // Get the row and column of the clicked cell
                    const row = $(this).parent().index();
                    const column = $(this).index();
                    // Call the makeMove function with the row and column
                    makeMove(row, column);
                });
            });
                
        </script>
    </body>
</html>